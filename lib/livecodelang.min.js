var livecodelang=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APPLICATION="APPLICATION",t.ASSIGNMENT="ASSIGNMENT",t.BINARYOP="BINARYOP",t.BLOCK="BLOCK",t.DEINDEX="DEINDEX",t.IF="IF",t.LAMBDA="LAMBDA",t.LIST="LIST",t.LOOP="LOOP",t.NUMBER="NUMBER",t.NULL="NULL",t.RETURN="RETURN",t.STRING="STRING",t.UNARYOP="UNARYOP",t.VARIABLE="VARIABLE"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2));var o=r.StandardTokenTypes,i=new r.Lexer({languageName:"live-code-lang"});i.addTokenType(o.whitespace()),i.addTokenType({name:"newline",regexp:/^\n[ \n]*/}),i.addTokenType({name:"comment",ignore:!0,regexp:/^\/\/[^\n]*/}),i.addTokenType(o.constant("if","if")),i.addTokenType(o.constant("else","else")),i.addTokenType(o.constant("loop","loop")),i.addTokenType(o.constant("times","times")),i.addTokenType(o.constant("with","with")),i.addTokenType(o.constant("return","return")),i.addTokenType(o.constant("=>","function arrow")),i.addTokenType({name:"operator",regexp:/^==/}),i.addTokenType(o.constant("=","assignment")),i.addTokenType(o.comma()),i.addTokenType(o.openParen()),i.addTokenType(o.closeParen()),i.addTokenType(o.openBracket()),i.addTokenType(o.closeBracket()),i.addTokenType(o.openSquareBracket()),i.addTokenType(o.closeSquareBracket()),i.addTokenType({name:"operator",regexp:/^[|&!<=>^%*/+-]+/}),i.addTokenType(o.floatingPoint()),i.addTokenType(o.integer()),i.addTokenType({name:"identifier",regexp:/^[a-zA-Z][a-zA-Z0-9]*/}),t.default=i},function(e,t,n){var r,o,i;o=[t],void 0===(i="function"==typeof(r=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i={lang:{isNullOrUndefined:function(e){return void 0===e||null===e}},extend:function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]}},a=function(e){function t(e){return n(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(Error),s=function(e){function t(e){return n(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(Error),u=function(e){function t(e){return n(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(Error),c=function(){function e(t){n(this,e),this.options=i.extend({},{languageName:"unnamedlanguage"},t),this.tokenTypes=[]}return t(e,[{key:"addTokenType",value:function(e){if(!e.name)throw new a("Token types must have a 'name' property");if(!e.regexp&&!e.consume)throw new a("Token types must have a 'regexp' property or a 'consume' function");if(e.regexp&&!(e.regexp instanceof RegExp))throw new a("Token types 'regexp' property must be an instance of RegExp");if(e.consume&&"function"!=typeof e.consume)throw new a("Token types 'consume' property must be a function");if(e.interpret&&"function"!=typeof e.interpret)throw new a("Token types 'interpret' property must be a function");this.tokenTypes.push(e)}},{key:"tokenize",value:function(e){if(void 0===e)throw new s("No content provided");if(0===this.tokenTypes.length)throw new s("No token types defined");for(var t,n,r=[],o=e,a=new l,u=this.tokenTypes.length;o.length>0;){for(var c=!1,p=0;p<u;p++){var h=this.tokenTypes[p];if(n=void 0,h.consume){if(!(n=h.consume(o)).success)continue;if(0!==o.indexOf(n.consumed))throw new s("The consume function for "+h.name+" failed to return the start of the remaining content at "+a.line+"."+a.character+" and instead returned "+n.consumed);c=!0,t=n.consumed}else{var f=h.regexp.exec(o);if(!f)continue;if(0!==f.index)continue;c=!0,t=f[0]}var d={content:e=h.interpret?h.interpret(t):n&&!i.lang.isNullOrUndefined(n.content)?n.content:t,type:h.name,line:a.line,character:a.character};h.ignore||r.push(d),o=o.substring(t.length),a.consume(t)}if(!c){var y=o.substring(0,15),k=y.replace("\r","\\r").replace("\t","\\t").replace("\n","\\n");throw new s("No viable alternative at "+a.line+"."+a.character+": '"+k+"...'")}}return r}}]),e}(),p=function(){function e(){n(this,e)}return t(e,null,[{key:"constant",value:function(e,t,n){return n=n||["keyword"],{name:t,regexp:new RegExp("^"+(r=e,r.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"))),role:n};var r}},{key:"floatingPoint",value:function(){return{name:"floating point",regexp:/(^-?\d*\.\d+)/,role:["constant","numeric"],interpret:function(e){return parseFloat(e)}}}},{key:"integer",value:function(){return{name:"integer",regexp:/^-?\d+/,role:["constant","numeric"],interpret:function(e){return parseInt(e)}}}},{key:"whitespace",value:function(){return{name:"whitespace",ignore:!0,regexp:/^[ \t]+/}}},{key:"whitespaceWithNewlines",value:function(){return{name:"whitespace",ignore:!0,regexp:/^[ \t\r\n]+/}}},{key:"real",value:function(){return{name:"real number",regexp:/^X/,role:["constant","numeric"]}}},{key:"comma",value:function(){return this.constant(",","comma",["punctuation"])}},{key:"period",value:function(){return this.constant(".","period",["punctuation"])}},{key:"star",value:function(){return this.constant("*","star",["punctuation"])}},{key:"colon",value:function(){return this.constant(":","colon",["punctuation"])}},{key:"openParen",value:function(){return this.constant("(","open paren",["punctuation"])}},{key:"closeParen",value:function(){return this.constant(")","close paren",["punctuation"])}},{key:"openBracket",value:function(){return this.constant("{","open bracket",["punctuation"])}},{key:"closeBracket",value:function(){return this.constant("}","close bracket",["punctuation"])}},{key:"openSquareBracket",value:function(){return this.constant("[","open square bracket",["punctuation"])}},{key:"closeSquareBracket",value:function(){return this.constant("]","close square bracket",["punctuation"])}},{key:"JsonString",value:function(){return{name:"string",regexp:/"(?:[^"\\]|\\.)*"/,consume:function(e){var t={success:!1};if(0!==e.indexOf('"'))return t;var n,r="",o=1,i=!1;do{switch(n=e[o],o+=1,n){case'"':i=!0;break;case"\\":var a=e[o];switch(o+=1,a){case'"':return t;case"t":r+="\t";break;case"r":r+="\r";break;case"n":r+="\n";break;case"u":var s=e.substr(o,4);if(4==s.length&&/\d{4}/.test(s)){o+=4;var u=parseInt(s,10),c=String.fromCharCode(u);r+=c}else r+="\\u";break;default:return t}break;default:r+=n}}while(!i);var p=e.substring(0,o),h={success:!0,consumed:p,content:r};return h}}}}]),e}(),h=function(){function e(){n(this,e)}return t(e,[{key:"initialize",value:function(e){if(!e)throw new u("No tokens provided to the parser");if(!(e instanceof Array))throw new u("A non-array was provided to the parser instead of a token array");this.tokens=e}},{key:"la1",value:function(e){if(this.eof())throw new u("No tokens available");return this.tokens[0].type==e}},{key:"match",value:function(e){if(this.eof())throw new u("Expected "+e+" but found EOF");if(!this.la1(e))throw new u("Expected "+e+" but found "+this.tokens[0].type+" at l"+this.tokens[0].line+"."+this.tokens[0].character);return this.tokens.shift()}},{key:"eof",value:function(){return 0===this.tokens.length}},{key:"expectEof",value:function(){if(!this.eof())throw new u("Expected EOF but found "+this.tokens[0].type+" at l"+this.tokens[0].line+"."+this.tokens[0].character)}}]),e}(),l=function(){function e(){n(this,e),this.line=1,this.character=1,this.justSeenSlashR=!1}return t(e,[{key:"consume",value:function(e){for(var t=0,n=e.length;t<n;t++)"\r"==e[t]?(this.line+=1,this.character=1,this.justSeenSlashR=!0):"\n"==e[t]?(this.justSeenSlashR||(this.line+=1),this.character=1,this.justSeenSlashR=!1):(this.character+=1,this.justSeenSlashR=!1)}}]),e}();e.PatternDefinitionException=a,e.LexerException=s,e.ParserException=u,e.Lexer=c,e.StandardTokenTypes=p,e.Parser=h,e.LineTracker=l})?r.apply(t,o):r)||(e.exports=i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Null=o,t.Block=function(e){return{type:r.BLOCK,elements:e}},t.Assignment=function(e,t){return{type:r.ASSIGNMENT,variable:e,expression:t}},t.Application=function(e,t){return{type:r.APPLICATION,func:e,args:t}},t.If=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o();return{type:r.IF,predicate:e,ifBlock:t,elseBlock:n}},t.Lambda=function(e,t){return{type:r.LAMBDA,argNames:e,body:t}},t.Return=function(e){return{type:r.RETURN,value:e}},t.Loop=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o();return{type:r.LOOP,number:e,block:t,loopVar:n}},t.UnaryOp=function(e,t){return{type:r.UNARYOP,operator:e,expr1:t}},t.BinaryOp=function(e,t,n){return{type:r.BINARYOP,operator:e,expr1:t,expr2:n}},t.DeIndex=function(e,t){return{type:r.DEINDEX,collection:e,index:t}},t.Num=function(e){return{type:r.NUMBER,value:e}},t.Variable=function(e){return{type:r.VARIABLE,identifier:e}},t.Str=function(e){return{type:r.STRING,value:e}},t.List=function(e){return{type:r.LIST,values:e}};var r=n(0);function o(){return{type:r.NULL}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=n(1),s=(r=a)&&r.__esModule?r:{default:r},u=p(n(3)),c=p(n(0));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=function(){function e(){h(this,e),this.operatorStack=[],this.output=[],this.precedences={"^":15,"*":14,"/":14,"%":14,"+":13,"-":13,"<":11,"<=":11,">":11,">=":11,"==":10,"!=":10,"&&":6,"||":5}}return o(e,[{key:"shuntValue",value:function(e){this.output.push(e)}},{key:"collapseOp",value:function(e){var t=this.output.pop(),n=this.output.pop(),r=u.BinaryOp(e,n,t);this.output.push(r)}},{key:"shuntOp",value:function(e){if(!this.precedences[e])throw new i.ParserException(e+" is not a valid operator");var t=this.operatorStack[this.operatorStack.length-1];if(this.precedences[e]<=this.precedences[t]){var n=this.operatorStack.pop();this.collapseOp(n)}this.operatorStack.push(e)}},{key:"getOutput",value:function(){for(;this.operatorStack.length>0;)this.collapseOp(this.operatorStack.pop());if(1!==this.output.length)throw new i.ParserException("Should only be a single expression in shunter output");return this.output.pop()}}]),e}(),f=new(function(){function e(){h(this,e)}return o(e,[{key:"initialize",value:function(e){if(!e)throw new i.ParserException("No tokens provided to the parser");if(!(e instanceof Array))throw new i.ParserException("A non-array was provided to the parser instead of a token array");this.tokens=e}},{key:"la1",value:function(e){if(this.eof())throw new i.ParserException("No tokens available: Cannot find "+e);return this.tokens[0].type==e}},{key:"lan",value:function(e,t){if(this.eof())throw new i.ParserException("No tokens available: Cannot find "+t);return this.tokens[e-1].type==t}},{key:"match",value:function(e){if(this.eof())throw new i.ParserException("Expected "+e+" but found EOF");if(!this.la1(e)){var t=this.tokens[0],n=t.type,r=t.content,o=t.line,a=t.character;throw new i.ParserException("Expected "+e+" but found "+n+" ("+r+") at l"+o+"."+a)}return this.tokens.shift()}},{key:"eof",value:function(){return 0===this.tokens.length}},{key:"expectEof",value:function(){if(!this.eof()){var e=this.tokens[0],t=e.type,n=e.line,r=e.character;throw new i.ParserException("Expected EOF but found "+t+" at l"+n+"."+r)}}}]),e}());f.program=function(){return this.block()},f.block=function(){for(var e=[];!this.eof()&&!this.la1("close bracket");)this.la1("newline")?this.match("newline"):e.push(this.statement());return u.Block(e)},f.statement=function(){if(this.la1("return")){this.match("return");var e=this.expression();return u.Return(e)}return this.la1("if")?this.ifStatement():this.la1("loop")?this.loop():this.lan(2,"assignment")?this.assignment():this.expression()},f.assignment=function(){var e=this.match("identifier").content;this.match("assignment");var t=this.expression();return u.Assignment(u.Variable(e),t)},f.application=function(){var e=this.match("identifier").content;this.match("open paren");var t=this.exprList();return this.match("close paren"),u.Application(u.Variable(e),t)},f.ifStatement=function(){this.match("if");var e=this.expression();this.match("open bracket"),this.match("newline");var t=this.block();if(this.match("close bracket"),!this.eof()&&this.la1("else")){this.match("else"),this.match("open bracket"),this.match("newline");var n=this.block();return this.match("close bracket"),u.If(e,t,n)}return u.If(e,t)},f.loop=function(){this.match("loop");var e=this.expression();this.match("times");var t=void 0;this.la1("with")&&(this.match("with"),t=u.Variable(this.match("identifier").content)),this.match("open bracket");var n=this.block();return this.match("close bracket"),u.Loop(e,n,t)},f.exprList=function(){var e=[];if(this.la1("close paren"))return e;for(e.push(this.expression());this.la1("comma");)this.match("comma"),e.push(this.expression());return e},f.expression=function(){var e=this.baseExpression();return!this.eof()&&this.la1("operator")&&(e=this.arithmatic(e)),e},f.baseExpression=function(){var e=void 0;if(this.la1("open square bracket"))e=this.list();else if(this.la1("floating point"))e=u.Num(this.match("floating point").content);else if(this.la1("integer"))e=u.Num(this.match("integer").content);else if(this.la1("operator"))e=u.UnaryOp(this.match("operator").content,this.expression());else if(this.la1("identifier")){if(e=u.Variable(this.match("identifier").content),this.eof())return e;if(this.la1("open paren")){this.match("open paren");var t=this.exprList();this.match("close paren"),e=u.Application(e,t)}}else{if(!this.la1("open paren")){var n=this.tokens[0],r=n.type,o=n.content,a=n.line,s=n.character;throw new i.ParserException("Could not parse Expression on "+r+" ("+o+") at l"+a+"."+s)}this.match("open paren");var c=this.exprList();if(this.match("close paren"),!this.eof()&&this.la1("function arrow"))e=this.lambda(c);else{if(c.length<=0)throw new i.ParserException("Cannot have an empty parenthesised expression");if(c.length>=2)throw new i.ParserException("No support for tuples, sorry");e=c[0]}}for(;!this.eof()&&this.la1("open square bracket");)e=this.deindex(e);return e},f.deindex=function(e){this.match("open square bracket");var t=this.expression();return this.match("close square bracket"),u.DeIndex(e,t)},f.arithmatic=function(e){var t=new l;for(t.shuntValue(e);!this.eof()&&this.la1("operator");)t.shuntOp(this.match("operator").content),t.shuntValue(this.baseExpression());return t.getOutput()},f.list=function(){this.match("open square bracket");var e=this.exprList();return this.match("close square bracket"),u.List(e)};f.lambda=function(e){var t=function(e){return e.map(function(e){if(e.type!==c.VARIABLE)throw new i.ParserException("Lambda definition args should not be expressions but found "+e.type);return e.identifier})}(e);if(this.match("function arrow"),this.match("open bracket"),this.la1("newline")){var n=this.block();return this.match("close bracket"),u.Lambda(t,n)}var r=this.expression();return this.match("close bracket"),u.Lambda(t,r)},f.nameList=function(){var e=[];if(this.la1("close paren"))return e;for(e.push(this.match("identifier").content);this.la1("comma");)this.match("comma"),e.push(this.match("identifier").content);return e},f.parse=function(e){var t=s.default.tokenize(e);return this.initialize(t),this.program()},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lexer=t.parser=void 0;var r=i(n(4)),o=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}t.parser=r.default,t.lexer=o.default}]);
//# sourceMappingURL=livecodelang.min.js.map